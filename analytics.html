<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <title>Season Analytics ‚Ä¢ Slayter League</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600;700&family=Roboto:wght@300;400;500;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles.css" />
    <link rel="stylesheet" href="assets/analytics.css" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.js"></script>
  </head>
  <body class="analytics-page">
    <div class="scroll-progress"></div>

    <nav class="nav-menu nav-menu--persistent">
      <div class="nav-menu__container">
        <div class="nav-menu__brand">
          <span class="nav-menu__logo">üèéÔ∏è</span>
          <span class="nav-menu__title">Slayter League</span>
        </div>
        <button class="nav-toggle" type="button" aria-expanded="false" aria-controls="primary-nav">
          <span class="nav-toggle__label">Menu</span>
          <span class="nav-toggle__icon" aria-hidden="true"></span>
        </button>
        <ul id="primary-nav" class="nav-menu__links nav-menu__links--collapsible">
          <li><a href="pages/home.html" class="nav-menu__link">Home</a></li>
          <li><a href="pages/standings.html" class="nav-menu__link">Standings</a></li>
          <li><a href="pages/sessions.html" class="nav-menu__link">Sessions</a></li>
          <li><a href="pages/calendar.html" class="nav-menu__link">Calendar</a></li>
          <li><a href="#insights" class="nav-menu__link">Insights</a></li>
          <li>
            <a href="analytics.html" class="nav-menu__link nav-menu__link--active" aria-current="page">Analytics</a>
          </li>
        </ul>
      </div>
    </nav>

    <header class="hero hero--analytics">
      <div class="hero__overlay"></div>
      <div class="hero__content hero__content--analytics">
        <p class="hero__eyebrow">Slayter League</p>
        <h1 class="hero__title">Season Analytics</h1>
        <p class="hero__subtitle">
          Dive deep into the league data with interactive charts, rolling insights, and secure driver comparisons.
        </p>
        <a class="hero__cta" href="#season-controls">Explore the Data</a>
      </div>
    </header>

    <main id="top" class="analytics-main">
      <section id="insights" class="section section--pad insights-section">
        <div class="container">
          <header class="section__header insights-section__header">
            <div>
              <h2>Championship Insights</h2>
              <p class="section__subtitle">
                Snapshot trends that move with your season and timeline selection.
              </p>
            </div>
            <div class="insights-section__meta">
              <span id="insight-round-label">Awaiting race data‚Ä¶</span>
            </div>
          </header>

          <div class="insights-grid">
            <article class="insight-card" data-insight="leader">
              <h3 class="insight-card__title">Championship Leader</h3>
              <p id="insight-leader-name" class="insight-card__value">-</p>
              <p id="insight-leader-points" class="insight-card__meta">0 pts</p>
            </article>
            <article class="insight-card" data-insight="wins">
              <h3 class="insight-card__title">Most Wins</h3>
              <p id="insight-wins-name" class="insight-card__value">-</p>
              <p id="insight-wins-count" class="insight-card__meta">0 wins</p>
            </article>
            <article class="insight-card" data-insight="watch">
              <h3 class="insight-card__title">Driver to Watch</h3>
              <p id="insight-watch-name" class="insight-card__value">-</p>
              <p id="insight-watch-meta" class="insight-card__meta">Stay tuned</p>
            </article>
          </div>

          <div class="insights-panels">
            <article class="insight-panel">
              <header class="insight-panel__header">
                <h3>Performance Pulse</h3>
                <p>Where the championship favourites stand right now.</p>
              </header>
              <div id="insight-performance" class="insight-panel__body"></div>
            </article>
            <article class="insight-panel">
              <header class="insight-panel__header">
                <h3>Podium Spotlight</h3>
                <p>Drivers turning starts into trophies.</p>
              </header>
              <div id="insight-podiums" class="insight-panel__body"></div>
            </article>
          </div>
        </div>
      </section>

      <section class="section section--pad" id="season-controls">
        <div class="container">
          <div class="season-controls">
            <label class="season-select">
              <span class="season-select__label">Season</span>
              <select id="season-select" aria-label="Select season"></select>
            </label>
            <div class="season-pills" id="season-pills" role="listbox" aria-label="Season quick select"></div>
          </div>
        </div>
      </section>

      <section class="section section--alt timeline-section">
        <div class="container">
          <header class="section__header">
            <div>
              <h2>Race Timeline</h2>
              <p class="section__subtitle">Drag the slider to see how the championship evolved race-by-race.</p>
            </div>
            <div class="timeline-display">
              <span class="timeline-label">Through Race:</span>
              <span class="timeline-value" id="timeline-value">All Races</span>
            </div>
          </header>

          <div class="timeline-control">
            <button id="timeline-play" class="timeline-btn" aria-label="Play timeline">
              <span class="play-icon">‚ñ∂</span>
              <span class="pause-icon" style="display: none">‚è∏</span>
            </button>
            <div class="timeline-slider-wrapper">
              <input
                type="range"
                id="timeline-slider"
                class="timeline-slider"
                min="0"
                max="11"
                value="11"
                step="1"
                aria-label="Race timeline slider"
              />
              <div class="timeline-ticks" id="timeline-ticks"></div>
            </div>
            <button id="timeline-reset" class="timeline-btn timeline-btn--secondary" aria-label="Reset timeline">
              Reset
            </button>
          </div>
        </div>
      </section>

      <section class="section section--pad">
        <div class="container">
          <div class="chart-card">
            <header class="chart-card__header">
              <div>
                <h3>Points Progression</h3>
                <p class="chart-subtitle">Championship points accumulated over the season</p>
              </div>
              <div class="chart-controls">
                <label class="chart-toggle">
                  <input type="checkbox" id="toggle-drivers" checked />
                  <span>Drivers</span>
                </label>
                <label class="chart-toggle">
                  <input type="checkbox" id="toggle-teams" />
                  <span>Teams</span>
                </label>
              </div>
            </header>
            <div class="chart-container">
              <canvas id="points-chart"></canvas>
            </div>
          </div>
        </div>
      </section>

      <section class="section section--alt">
        <div class="container">
          <div class="chart-card">
            <header class="chart-card__header">
              <div>
                <h3>Points Gap to Leader</h3>
                <p class="chart-subtitle">How far each contender trails the championship leader after every race</p>
              </div>
            </header>
            <div class="chart-container">
              <canvas id="points-gap-chart"></canvas>
            </div>
          </div>
        </div>
      </section>

      <section class="section section--pad">
        <div class="container">
          <div class="chart-card">
            <header class="chart-card__header">
              <div>
                <h3>Championship Position Tracker</h3>
                <p class="chart-subtitle">Driver ranking after each race (lower lines mean higher positions)</p>
              </div>
            </header>
            <div class="chart-container">
              <canvas id="position-change-chart"></canvas>
            </div>
          </div>
        </div>
      </section>

      <section class="section section--alt">
        <div class="container">
          <div class="chart-card">
            <header class="chart-card__header">
              <div>
                <h3>Position Heatmap</h3>
                <p class="chart-subtitle">Finishing positions across all races (darker = better finish)</p>
              </div>
              <div class="chart-controls">
                <label class="chart-select">
                  <span>Sort by:</span>
                  <select id="heatmap-sort">
                    <option value="points">Total Points</option>
                    <option value="avg">Avg Position</option>
                    <option value="name">Driver Name</option>
                  </select>
                </label>
              </div>
            </header>
            <div class="heatmap-container" id="heatmap-container"></div>
          </div>
        </div>
      </section>

      <section class="section section--pad">
        <div class="container">
          <div class="chart-card">
            <header class="chart-card__header">
              <div>
                <h3>Podium Distribution</h3>
                <p class="chart-subtitle">Breakdown of finishing positions for top drivers</p>
              </div>
              <div class="chart-controls">
                <label class="chart-select">
                  <span>Show:</span>
                  <select id="podium-filter">
                    <option value="10">Top 10 Drivers</option>
                    <option value="5">Top 5 Drivers</option>
                    <option value="all">All Drivers</option>
                  </select>
                </label>
              </div>
            </header>
            <div class="chart-container">
              <canvas id="podium-chart"></canvas>
            </div>
          </div>
        </div>
      </section>

      <section class="section section--alt">
        <div class="container">
          <div class="chart-card">
            <header class="chart-card__header">
              <div>
                <h3>Form Guide (3-Race Rolling Average)</h3>
                <p class="chart-subtitle">Track who's heating up or cooling down</p>
              </div>
            </header>
            <div class="chart-container">
              <canvas id="trend-chart"></canvas>
            </div>
          </div>
        </div>
      </section>

      <section class="section section--pad">
        <div class="container">
          <div class="chart-card">
            <header class="chart-card__header">
              <div>
                <h3>Fastest Lap Analysis</h3>
                <p class="chart-subtitle">Average ranking position based on fastest lap times across all races</p>
              </div>
            </header>
            <div class="chart-container">
              <canvas id="fastest-lap-chart"></canvas>
            </div>
            <div class="fastest-lap-stats" id="fastest-lap-stats"></div>
          </div>
        </div>
      </section>

      <section class="section section--alt">
        <div class="container">
          <div class="chart-card">
            <header class="chart-card__header">
              <div>
                <h3>Head-to-Head Battle</h3>
                <p class="chart-subtitle">Compare two drivers race-by-race</p>
              </div>
              <div class="chart-controls chart-controls--h2h">
                <label class="chart-select">
                  <span>Driver 1:</span>
                  <select id="h2h-driver1"></select>
                </label>
                <span class="h2h-vs" aria-hidden="true">vs</span>
                <label class="chart-select">
                  <span>Driver 2:</span>
                  <select id="h2h-driver2"></select>
                </label>
              </div>
            </header>
            <div class="chart-container">
              <canvas id="h2h-chart"></canvas>
            </div>
            <div class="h2h-summary" id="h2h-summary"></div>
          </div>
        </div>
      </section>
    </main>

    <footer class="footer">
      <p>
        Built for the Slayter League ‚Ä¢
        <a href="pages/home.html">Home</a> ‚Ä¢
        <a href="pages/standings.html">Standings</a> ‚Ä¢
        <a href="pages/sessions.html">Sessions</a> ‚Ä¢
        <a href="pages/calendar.html">Calendar</a> ‚Ä¢
        <a href="pages/insights.html">Insights</a> ‚Ä¢
        <a href="analytics.html" aria-current="page">Analytics</a>
      </p>
      <p class="footer__note">
        Data-driven by <code>v2/data/seasons.json</code> ‚Ä¢ ¬© <span id="footer-year"></span> Slayter League
      </p>
    </footer>

    <script src="assets/analytics.js" type="module"></script>
  </body>
</html>
